{% extends 'base.html' %} {% block content %}

<div class="login-wrapper">
  <div class="card login-card shadow-lg p-4">
    <!-- Ti√™u ƒë·ªÅ -->
    <div class="text-center mb-3">
      <div class="logo-circle mb-3">
        <i class="bi bi-person-plus-fill fs-1 text-success"></i>
      </div>
      <h2 class="fw-bold text-gradient">ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
      <p class="text-muted">
        Vui l√≤ng nh·∫≠p th√¥ng tin b√™n d∆∞·ªõi ƒë·ªÉ t·∫°o t√†i kho·∫£n
      </p>
    </div>

    <!-- üîî Flash messages -->
    <!-- Form ƒëƒÉng k√Ω -->
    <form method="post">
      <!-- H·ªç t√™n -->
      <div class="mb-3 input-group rounded-pill shadow-sm">
        <span class="input-group-text"
          ><i class="bi bi-person-fill text-primary"></i
        ></span>
        <input
          type="text"
          name="ho_ten"
          class="form-control border-0 rounded-end rounded-pill"
          placeholder="H·ªç v√† t√™n"
          required
        />
      </div>

      <!-- Gi·ªõi t√≠nh -->
      <div class="mb-3 input-group rounded-pill shadow-sm">
        <span class="input-group-text"
          ><i class="bi bi-gender-ambiguous text-primary"></i
        ></span>
        <select
          name="gioi_tinh"
          class="form-select border-0 rounded-end rounded-pill"
          required
        >
          <option value="">-- Ch·ªçn gi·ªõi t√≠nh --</option>
          <option value="Nam">Nam</option>
          <option value="N·ªØ">N·ªØ</option>
        </select>
      </div>

      <!-- Ng√†y sinh -->
      <div class="mb-3 input-group rounded-pill shadow-sm">
        <span class="input-group-text"
          ><i class="bi bi-calendar-date text-primary"></i
        ></span>
        <input
          type="date"
          name="ngay_sinh"
          class="form-control border-0 rounded-end rounded-pill"
          max="{{ today }}"
          required
        />
      </div>

      <!-- Email -->
      <div class="mb-3 input-group rounded-pill shadow-sm">
        <span class="input-group-text"
          ><i class="bi bi-envelope-fill text-primary"></i
        ></span>
        <input
          type="email"
          name="email"
          class="form-control border-0 rounded-end rounded-pill"
          placeholder="Email"
          required
        />
      </div>

      <!-- M·∫≠t kh·∫©u -->
      <div class="mb-3 input-group rounded-pill shadow-sm position-relative password-toggle-group overflow-hidden">
        <span class="input-group-text"
          ><i class="bi bi-lock-fill text-primary"></i
        ></span>
        <input
          type="password"
          name="mat_khau"
          id="pwInput"
          class="form-control border-0 rounded-end rounded-pill"
          placeholder="M·∫≠t kh·∫©u (√≠t nh·∫•t 8 k√Ω t·ª±, c√≥ k√Ω t·ª± ƒë·∫∑c bi·ªát, ch·ªØ hoa v√† s·ªë)"
          required
        />
        <button
          class="btn btn-link border-0 text-muted toggle-password"
          type="button"
          data-target="pwInput"
          aria-label="·∫®n/hi·ªán m·∫≠t kh·∫©u"
        >
          <i class="bi bi-eye-slash-fill"></i>
        </button>
      </div>

      <!-- Nh·∫≠p l·∫°i m·∫≠t kh·∫©u -->
      <div class="mb-4 input-group rounded-pill shadow-sm position-relative password-toggle-group overflow-hidden">
        <span class="input-group-text"
          ><i class="bi bi-shield-lock-fill text-primary"></i
        ></span>
        <input
          type="password"
          name="mat_khau_confirm"
          id="pwConfirmInput"
          class="form-control border-0 rounded-end rounded-pill"
          placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
          required
        />
        <button
          class="btn btn-link border-0 text-muted toggle-password"
          type="button"
          data-target="pwConfirmInput"
          aria-label="·∫®n/hi·ªán m·∫≠t kh·∫©u x√°c nh·∫≠n"
        >
          <i class="bi bi-eye-slash-fill"></i>
        </button>
      </div>

      <!-- Hi·ªÉn th·ªã ƒë·ªô m·∫°nh m·∫≠t kh·∫©u -->
      <div class="text-center mb-3">
        <small id="pwStrength" class="fw-semibold"></small>
      </div>

      <!-- N√∫t ƒëƒÉng k√Ω -->
      <button
        type="submit"
        class="btn btn-success w-100 py-2 rounded-pill fw-semibold shadow-sm"
      >
        ƒêƒÉng k√Ω
      </button>

      {% if social_google_enabled %}
      <div class="mt-3 border-top pt-3">
        <p class="text-center text-muted small mb-3">Ho·∫∑c ti·∫øp t·ª•c v·ªõi</p>
        <div class="d-grid gap-2">
          <a
            href="{{ url_for('oauth_login', provider='google') }}"
            class="btn btn-outline-danger rounded-pill fw-semibold"
          >
            <i class="bi bi-google me-2"></i> Google
          </a>
        </div>
      </div>
      {% endif %}

      <p class="text-center mt-3 small text-muted">
        ƒê√£ c√≥ t√†i kho·∫£n?
        <a
          href="{{ url_for('login') }}"
          class="text-decoration-none fw-semibold"
          >ƒêƒÉng nh·∫≠p</a
        >
      </p>
    </form>
  </div>
</div>

<!-- Script ki·ªÉm tra ƒë·ªô m·∫°nh m·∫≠t kh·∫©u -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("pwInput");
    const label = document.getElementById("pwStrength");

    input.addEventListener("input", () => {
      const val = input.value;
      let s = 0;
      if (val.length >= 8) s++;
      if (/[A-Z]/.test(val)) s++;
      if (/\d/.test(val)) s++;
      if (/[@$!%*?&]/.test(val)) s++;

      if (!val) {
        label.innerHTML = "";
      } else if (s <= 1) {
        label.innerHTML = "üî¥ M·∫≠t kh·∫©u y·∫øu";
        label.className = "text-danger fw-semibold";
      } else if (s === 2 || s === 3) {
        label.innerHTML = "üü° M·∫≠t kh·∫©u trung b√¨nh";
        label.className = "text-warning fw-semibold";
      } else {
        label.innerHTML = "üü¢ M·∫≠t kh·∫©u m·∫°nh";
        label.className = "text-success fw-semibold";
      }
    });

    document.querySelectorAll(".toggle-password").forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = document.getElementById(btn.dataset.target);
        if (!target) return;
        const isHidden = target.type === "password";
        target.type = isHidden ? "text" : "password";
        const icon = btn.querySelector("i");
        if (icon) {
          icon.classList.toggle("bi-eye-fill", isHidden);
          icon.classList.toggle("bi-eye-slash-fill", !isHidden);
        }
      });
    });
  });
</script>


{% endblock %}
